tinymce.PluginManager.add("filebrowser",function(t){function e(){window.top.Easy.ShowUrlWindow({url:"/admin/Media/MultiSelect",title:"Media",zindex:1e4,onLoad:function(e){window.top.$(this.document).find("#confirm").click(function(){$(".multi-select:not(.unchecked)",$(this).closest("body")).each(function(){var e=n({src:$(this).data("result"),name:$(this).data("name")});e.ele&&t.undoManager.transact(function(){t.selection.setContent(t.dom.createHTML(e.ele,e.attr,e.innerText))})}),t.focus(),t.nodeChanged(),e.close()}),window.top.$(this.document).on("click",".confirm",function(){var o=n({src:$(this).data("result"),name:$(this).data("name")});o.ele&&(t.undoManager.transact(function(){t.selection.setContent(t.dom.createHTML(o.ele,o.attr,o.innerText))}),t.focus(),t.nodeChanged()),e.close()})}})}function n(t){var e=t.src,n=t.name,o={ele:"",attr:{},innerText:""},c=e.toLowerCase();return/.*(\.jpg|\.gif|\.png|\.jpeg|\.bmp|\.jpe)$/.test(c)?(o.ele="img",o.attr={src:e,title:n,alt:n}):/.*(\.mp4)$/.test(c)?(o.ele="video",o.attr={controls:"controls",src:e,title:n}):/.*(\.mp3|\.ogg|\.wav)$/.test(c)?(o.ele="audio",o.attr={controls:"controls",src:e,title:n}):(o.ele="a",o.attr={href:e,class:"btn btn-default",download:n,title:n},o.innerText="下载"),o}var o='<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t viewBox="0 0 512.001 512.001" style="enable-background:new 0 0 512.001 512.001;" xml:space="preserve" width="24" height="24"><g><g><g><path d="M492.971,211.64h-50.443v-63.41c0-10.502-8.514-19.016-19.016-19.016H189.695V63.91c0-10.502-8.514-19.016-19.016-19.016\t\t\t\tH19.016C8.514,44.894,0,53.408,0,63.91c0,13.692,0.001,370.375,0.001,384.179c0,10.432,8.48,19.017,19.029,19.017\t\t\t\tc0.01,0,0.02-0.001,0.03-0.001h404.453c8.273,0,15.597-5.349,18.115-13.23l69.459-217.435\t\t\t\tC515.005,224.175,505.831,211.64,492.971,211.64z M38.032,82.926h113.631v46.288H38.032V82.926z M38.032,167.247\t\t\t\tc8.343,0,359.629-0.001,366.464-0.001v44.394H88.489c-8.272,0-15.596,5.349-18.115,13.229L38.032,326.092V167.247z\t\t\t\t M409.625,429.073H45.057l57.321-179.403c11.05,0,346.991,0,364.557,0L409.625,429.073z"/>\t\t\t<path d="M206.005,358.389h30.973v30.973c0,10.502,8.514,19.016,19.016,19.016c10.502,0,19.016-8.514,19.016-19.016v-30.973\t\t\t\th30.973c10.502,0,19.016-8.514,19.016-19.016c0-10.503-8.514-19.016-19.016-19.016H275.01v-30.973\t\t\t\tc0-10.502-8.514-19.016-19.016-19.016c-10.502,0-19.016,8.514-19.016,19.016v30.973h-30.973\t\t\t\tc-10.502,0-19.016,8.514-19.016,19.016C186.989,349.875,195.503,358.389,206.005,358.389z"/></g></g></svg>';t.ui.registry.addIcon("folder",o),t.ui.registry.addButton("filebrowser",{icon:"folder",tooltip:"媒体库",onAction:e})});